# Trading Journal - æŠ€æœ¯è·¯å¾„è¯¦è§£

> æœ€åæ›´æ–°: 2026å¹´2æœˆ4æ—¥

## ğŸ“‹ ç›®å½•

1. [å‰ç«¯æŠ€æœ¯æ ˆ](#å‰ç«¯æŠ€æœ¯æ ˆ)
2. [åç«¯æ¶æ„](#åç«¯æ¶æ„)
3. [æ•°æ®æµè®¾è®¡](#æ•°æ®æµè®¾è®¡)
4. [APIé›†æˆ](#apié›†æˆ)
5. [çŠ¶æ€ç®¡ç†](#çŠ¶æ€ç®¡ç†)
6. [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)

---

## ğŸ¨ å‰ç«¯æŠ€æœ¯æ ˆ

### 1. React 18 + TypeScript

**é€‰æ‹©ç†ç”±**:
- **ç±»å‹å®‰å…¨**: TypeScriptå‡å°‘è¿è¡Œæ—¶é”™è¯¯ï¼Œæå‡ä»£ç è´¨é‡
- **ç»„ä»¶åŒ–**: Reactç»„ä»¶åŒ–å¼€å‘ï¼Œä»£ç å¤ç”¨æ€§é«˜
- **ç”Ÿæ€æˆç†Ÿ**: ä¸°å¯Œçš„ç¬¬ä¸‰æ–¹åº“å’Œå·¥å…·é“¾
- **Hooks**: ç®€åŒ–çŠ¶æ€ç®¡ç†å’Œå‰¯ä½œç”¨å¤„ç†

**æ ¸å¿ƒHooksä½¿ç”¨**:
```typescript
// App.tsx - ä¸»åº”ç”¨çŠ¶æ€ç®¡ç†
const [positions, setPositions] = useState<Position[]>([]);
const [transactions, setTransactions] = useState<Transaction[]>([]);
const [loading, setLoading] = useState(true);
const [session, setSession] = useState<Session | null>(null);

// æ•°æ®è·å–
useEffect(() => {
  fetchData();
}, [session]);

// æ€§èƒ½ä¼˜åŒ–
const memoizedValue = useMemo(() => expensiveCalculation(), [deps]);
const handleAction = useCallback(() => { /* ... */ }, [deps]);
```

### 2. Vite æ„å»ºå·¥å…·

**ä¼˜åŠ¿**:
- âš¡ **æå¿«çš„å¼€å‘æœåŠ¡å™¨**: åŸºäºESMçš„å³æ—¶çƒ­æ›´æ–°
- ğŸ“¦ **ä¼˜åŒ–çš„ç”Ÿäº§æ„å»º**: åŸºäºRollupçš„é«˜æ•ˆæ‰“åŒ…
- ğŸ”Œ **æ’ä»¶ç”Ÿæ€**: ä¸°å¯Œçš„æ’ä»¶æ”¯æŒ
- ğŸ¯ **å¼€ç®±å³ç”¨**: é›¶é…ç½®æ”¯æŒTypeScriptã€JSXç­‰

**é…ç½®äº®ç‚¹** (`vite.config.ts`):
```typescript
export default defineConfig({
  plugins: [react()],
  server: {
    port: 3000,
    open: true
  },
  build: {
    outDir: 'dist',
    sourcemap: true,
    rollupOptions: {
      output: {
        manualChunks: {
          'vendor': ['react', 'react-dom'],
          'charts': ['recharts']
        }
      }
    }
  }
});
```

### 3. Tailwind CSS

**è®¾è®¡ç³»ç»Ÿ**:
- **å“åº”å¼æ–­ç‚¹**:
  ```css
  sm: 640px   /* Mobile landscape */
  md: 768px   /* Tablet */
  lg: 1024px  /* Desktop */
  xl: 1280px  /* Large desktop */
  ```

- **é¢œè‰²ç³»ç»Ÿ**:
  ```javascript
  colors: {
    primary: '#3b82f6',    // Blue
    success: '#10b981',    // Green
    warning: '#f59e0b',    // Amber
    danger: '#ef4444',     // Red
    dark: '#1e293b',       // Slate-800
  }
  ```

- **è‡ªå®šä¹‰å·¥å…·ç±»**:
  ```css
  .card-hover {
    @apply transition-all duration-200 hover:shadow-lg hover:-translate-y-1;
  }
  
  .btn-primary {
    @apply bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded;
  }
  ```

### 4. ç»„ä»¶æ¶æ„

**ç›®å½•ç»“æ„**:
```
src/
â”œâ”€â”€ components/          # å¯å¤ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ TabNav.tsx      # åº•éƒ¨å¯¼èˆªæ 
â”‚   â”œâ”€â”€ PositionCard.tsx # æŒä»“å¡ç‰‡
â”‚   â”œâ”€â”€ WatchlistItem.tsx # è§‚å¯Ÿåˆ—è¡¨é¡¹
â”‚   â”œâ”€â”€ BuyModal.tsx    # ä¹°å…¥å¼¹çª—
â”‚   â”œâ”€â”€ LoadingSpinner.tsx # åŠ è½½åŠ¨ç”»
â”‚   â””â”€â”€ GreeksHistoryChart.tsx # Greekså›¾è¡¨
â”œâ”€â”€ pages/              # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ Portfolio.tsx   # æŒä»“é¡µé¢
â”‚   â”œâ”€â”€ Watchlist.tsx   # è§‚å¯Ÿåˆ—è¡¨é¡µé¢
â”‚   â”œâ”€â”€ Scanner.tsx     # æ‰«æå™¨é¡µé¢
â”‚   â”œâ”€â”€ History.tsx     # å†å²é¡µé¢
â”‚   â”œâ”€â”€ Stats.tsx       # ç»Ÿè®¡é¡µé¢
â”‚   â””â”€â”€ Login.tsx       # ç™»å½•é¡µé¢
â”œâ”€â”€ lib/                # å·¥å…·åº“
â”‚   â”œâ”€â”€ supabase.ts     # Supabaseå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ types.ts        # TypeScriptç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ utils.ts        # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ scoring.ts      # è¯„åˆ†ç®—æ³•
â”‚   â””â”€â”€ greeksHistory.ts # Greekså†å²ç®¡ç†
â”œâ”€â”€ App.tsx             # ä¸»åº”ç”¨ç»„ä»¶
â”œâ”€â”€ main.tsx            # åº”ç”¨å…¥å£
â””â”€â”€ index.css           # å…¨å±€æ ·å¼
```

**ç»„ä»¶è®¾è®¡åŸåˆ™**:
1. **å•ä¸€èŒè´£**: æ¯ä¸ªç»„ä»¶åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½
2. **Propsæ¥å£**: æ˜ç¡®çš„TypeScriptæ¥å£å®šä¹‰
3. **çŠ¶æ€æå‡**: å…±äº«çŠ¶æ€æå‡åˆ°çˆ¶ç»„ä»¶
4. **çº¯å‡½æ•°**: å°½å¯èƒ½ä½¿ç”¨çº¯å‡½æ•°ç»„ä»¶

---

## ğŸ”§ åç«¯æ¶æ„

### 1. Supabase (BaaS)

**æ ¸å¿ƒæœåŠ¡**:
- **PostgreSQLæ•°æ®åº“**: å…³ç³»å‹æ•°æ®å­˜å‚¨
- **REST API**: è‡ªåŠ¨ç”Ÿæˆçš„RESTful API
- **Realtime**: WebSocketå®æ—¶è®¢é˜…
- **Auth**: ç”¨æˆ·è®¤è¯å’Œæˆæƒ
- **Storage**: æ–‡ä»¶å­˜å‚¨ï¼ˆæœªæ¥ä½¿ç”¨ï¼‰

**å®¢æˆ·ç«¯åˆå§‹åŒ–**:
```typescript
// src/lib/supabase.ts
import { createClient } from '@supabase/supabase-js';

const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;
const supabaseKey = import.meta.env.VITE_SUPABASE_ANON_KEY;

export const supabase = createClient(supabaseUrl, supabaseKey);
```

**æ•°æ®æ“ä½œç¤ºä¾‹**:
```typescript
// æŸ¥è¯¢æ‰€æœ‰æ´»è·ƒæŒä»“
const { data, error } = await supabase
  .from('positions')
  .select('*, transactions(*)')
  .eq('status', 'active')
  .order('created_at', { ascending: false });

// æ’å…¥æ–°æŒä»“
const { data, error } = await supabase
  .from('positions')
  .insert([{ ticker, strike, type, expiration, ... }])
  .select();

// æ›´æ–°æŒä»“ä»·æ ¼
const { error } = await supabase
  .from('positions')
  .update({ current_price: newPrice })
  .eq('id', positionId);

// åˆ é™¤æŒä»“ï¼ˆçº§è”åˆ é™¤transactionsï¼‰
const { error } = await supabase
  .from('positions')
  .delete()
  .eq('id', positionId);
```

### 2. Vercel Serverless Functions

**APIç«¯ç‚¹**:
```
/api/option-price.js    # æœŸæƒä»·æ ¼å’ŒGreeks
/api/earnings.js        # è´¢æŠ¥æ•°æ®ï¼ˆæœªæ¥ï¼‰
```

**Serverlessä¼˜åŠ¿**:
- âœ… é›¶æœåŠ¡å™¨ç®¡ç†
- âœ… è‡ªåŠ¨æ‰©å±•
- âœ… æŒ‰éœ€ä»˜è´¹
- âœ… å…¨çƒè¾¹ç¼˜ç½‘ç»œ

**å‡½æ•°ç»“æ„**:
```javascript
// api/option-price.js
export default async function handler(req, res) {
  // 1. CORSé…ç½®
  res.setHeader('Access-Control-Allow-Origin', '*');
  
  // 2. å‚æ•°éªŒè¯
  const { ticker, expiration, strike, type } = req.query;
  if (!ticker || !expiration || !strike || !type) {
    return res.status(400).json({ error: 'Missing parameters' });
  }
  
  // 3. è°ƒç”¨å¤–éƒ¨API
  const cboeUrl = `https://cdn.cboe.com/api/global/delayed_quotes/options/${ticker}.json`;
  const response = await fetch(cboeUrl);
  
  // 4. æ•°æ®å¤„ç†å’Œè¿”å›
  const data = await response.json();
  return res.status(200).json({ success: true, ... });
}
```

---

## ğŸ”„ æ•°æ®æµè®¾è®¡

### 1. æ•°æ®è·å–æµç¨‹

```
ç”¨æˆ·æ“ä½œ â†’ Reactç»„ä»¶ â†’ Supabase Client â†’ PostgreSQL
                â†“
         æ›´æ–°æœ¬åœ°çŠ¶æ€
                â†“
         é‡æ–°æ¸²æŸ“UI
```

**å®ç°ç¤ºä¾‹**:
```typescript
// Portfolio.tsx
const fetchPositions = async () => {
  setLoading(true);
  try {
    const { data, error } = await supabase
      .from('positions')
      .select('*, transactions(*)')
      .eq('status', 'active');
    
    if (error) throw error;
    setPositions(data);
  } catch (error) {
    console.error('Error fetching positions:', error);
  } finally {
    setLoading(false);
  }
};
```

### 2. ä»·æ ¼æ›´æ–°æµç¨‹

```
ç”¨æˆ·ç‚¹å‡»"Refresh Prices"
    â†“
éå†æ‰€æœ‰æŒä»“
    â†“
è°ƒç”¨ /api/option-price (å¹¶å‘)
    â†“
è·å–æœ€æ–°ä»·æ ¼å’ŒGreeks
    â†“
æ‰¹é‡æ›´æ–°Supabase
    â†“
æ›´æ–°æœ¬åœ°çŠ¶æ€
    â†“
UIæ˜¾ç¤ºæ–°ä»·æ ¼
```

**å®ç°ç¤ºä¾‹**:
```typescript
const refreshAllPrices = async () => {
  setRefreshing(true);
  
  const updates = await Promise.all(
    positions.map(async (pos) => {
      try {
        const response = await fetch(
          `/api/option-price?ticker=${pos.ticker}&expiration=${pos.expiration}&strike=${pos.strike}&type=${pos.type}`
        );
        const data = await response.json();
        
        return {
          id: pos.id,
          current_price: data.price,
          // æ›´æ–°Greeksåˆ°greeks_historyè¡¨
        };
      } catch (error) {
        console.error(`Error updating ${pos.ticker}:`, error);
        return null;
      }
    })
  );
  
  // æ‰¹é‡æ›´æ–°æ•°æ®åº“
  for (const update of updates.filter(Boolean)) {
    await supabase
      .from('positions')
      .update({ current_price: update.current_price })
      .eq('id', update.id);
  }
  
  setRefreshing(false);
  fetchPositions(); // é‡æ–°è·å–æ•°æ®
};
```

### 3. Scanneræ•°æ®æµ

```
ç”¨æˆ·è¾“å…¥Ticker + ç­–ç•¥
    â†“
è°ƒç”¨CBOE APIè·å–å®Œæ•´æœŸæƒé“¾
    â†“
å‰ç«¯æ‰§è¡Œè¯„åˆ†ç®—æ³•
    â†“
è®¡ç®—åŸå§‹æŒ‡æ ‡ï¼ˆLambda, Gamma Eff, Theta Burnï¼‰
    â†“
Z-Scoreæ ‡å‡†åŒ–
    â†“
åŠ æƒè®¡ç®—æœ€ç»ˆå¾—åˆ†
    â†“
æŒ‰å¾—åˆ†æ’åºå±•ç¤º
    â†“
ç”¨æˆ·é€‰æ‹©æ·»åŠ åˆ°Watchlist
```

---

## ğŸ”Œ APIé›†æˆ

### 1. CBOE API

**ç«¯ç‚¹**:
```
https://cdn.cboe.com/api/global/delayed_quotes/options/{TICKER}.json
```

**æ•°æ®ç»“æ„**:
```json
{
  "data": {
    "current_price": 620.24,
    "options": [
      {
        "option": "QQQ260220C00630000",
        "bid": 7.32,
        "ask": 7.39,
        "last_trade_price": 7.35,
        "delta": 0.3999,
        "gamma": 0.0123,
        "theta": -0.0456,
        "vega": 0.0789,
        "iv": 0.1778,
        "volume": 6485,
        "open_interest": 29600
      }
    ]
  }
}
```

**OCC Symbolç”Ÿæˆ**:
```javascript
function generateOCCSymbol(symbol, expiration, type, strike) {
  // QQQ   260220C00630000
  // ^^^   ^^^^^^ ^^^^^^^^
  // è‚¡ç¥¨  æ—¥æœŸ   ç±»å‹+è¡Œæƒä»·
  
  const paddedSymbol = symbol.padEnd(6, ' ');
  const [year, month, day] = expiration.split('-');
  const dateStr = `${year.slice(2)}${month}${day}`;
  const typeCode = type[0].toUpperCase(); // C or P
  const strikeStr = (strike * 1000).toString().padStart(8, '0');
  
  return `${paddedSymbol}${dateStr}${typeCode}${strikeStr}`;
}
```

### 2. é”™è¯¯å¤„ç†

**é‡è¯•æœºåˆ¶**:
```typescript
async function fetchWithRetry(url: string, maxRetries = 3) {
  for (let i = 0; i < maxRetries; i++) {
    try {
      const response = await fetch(url);
      if (response.ok) return response;
    } catch (error) {
      if (i === maxRetries - 1) throw error;
      await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1)));
    }
  }
}
```

**é™çº§ç­–ç•¥**:
```typescript
// å¦‚æœAPIå¤±è´¥ï¼Œå…è®¸æ‰‹åŠ¨è¾“å…¥
if (apiError) {
  return (
    <input
      type="number"
      placeholder="Enter price manually"
      onChange={(e) => updatePrice(e.target.value)}
    />
  );
}
```

---

## ğŸ§  çŠ¶æ€ç®¡ç†

### 1. æœ¬åœ°çŠ¶æ€ (useState)

**é€‚ç”¨åœºæ™¯**: ç»„ä»¶å†…éƒ¨çŠ¶æ€
```typescript
const [isOpen, setIsOpen] = useState(false);
const [inputValue, setInputValue] = useState('');
```

### 2. æå‡çŠ¶æ€ (Lifting State Up)

**é€‚ç”¨åœºæ™¯**: çˆ¶å­ç»„ä»¶å…±äº«çŠ¶æ€
```typescript
// App.tsx
const [positions, setPositions] = useState<Position[]>([]);

// ä¼ é€’ç»™å­ç»„ä»¶
<Portfolio 
  positions={positions} 
  onUpdate={setPositions} 
/>
```

### 3. Context API (æœªä½¿ç”¨ï¼Œä½†å¯è€ƒè™‘)

**é€‚ç”¨åœºæ™¯**: æ·±å±‚ç»„ä»¶æ ‘å…±äº«çŠ¶æ€
```typescript
const UserContext = createContext<User | null>(null);

function App() {
  const [user, setUser] = useState<User | null>(null);
  
  return (
    <UserContext.Provider value={user}>
      <Routes />
    </UserContext.Provider>
  );
}
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–

### 1. ä»£ç åˆ†å‰²

**åŠ¨æ€å¯¼å…¥**:
```typescript
const Scanner = lazy(() => import('./pages/Scanner'));

<Suspense fallback={<LoadingSpinner />}>
  <Scanner />
</Suspense>
```

### 2. ç¼“å­˜ç­–ç•¥

**React Query (æœªæ¥è€ƒè™‘)**:
```typescript
const { data, isLoading } = useQuery(
  ['positions', 'active'],
  fetchActivePositions,
  {
    staleTime: 5 * 60 * 1000, // 5åˆ†é’Ÿ
    cacheTime: 10 * 60 * 1000, // 10åˆ†é’Ÿ
  }
);
```

### 3. è™šæ‹ŸåŒ–åˆ—è¡¨

**å¯¹äºå¤§é‡æ•°æ®**:
```typescript
import { FixedSizeList } from 'react-window';

<FixedSizeList
  height={600}
  itemCount={positions.length}
  itemSize={120}
>
  {({ index, style }) => (
    <div style={style}>
      <PositionCard position={positions[index]} />
    </div>
  )}
</FixedSizeList>
```

### 4. é˜²æŠ–å’ŒèŠ‚æµ

**æœç´¢è¾“å…¥**:
```typescript
import { debounce } from 'lodash';

const handleSearch = debounce((value: string) => {
  // æ‰§è¡Œæœç´¢
}, 300);
```

---

## ğŸ”’ å®‰å…¨æ€§

### 1. ç¯å¢ƒå˜é‡

**æ•æ„Ÿä¿¡æ¯éš”ç¦»**:
```bash
# .env
VITE_SUPABASE_URL=https://xxx.supabase.co
VITE_SUPABASE_ANON_KEY=xxx

# .gitignore
.env
.env.local
```

### 2. Row Level Security (RLS)

**Supabaseç­–ç•¥**:
```sql
-- ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®
CREATE POLICY "Users can only access their own positions"
ON positions
FOR ALL
USING (auth.uid() = user_id);
```

### 3. è¾“å…¥éªŒè¯

**å‰ç«¯éªŒè¯**:
```typescript
const validateStrike = (value: string) => {
  const num = parseFloat(value);
  if (isNaN(num) || num <= 0) {
    return 'Invalid strike price';
  }
  return null;
};
```

---

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### 1. é”™è¯¯è¿½è¸ª

**Consoleæ—¥å¿—**:
```typescript
try {
  await riskyOperation();
} catch (error) {
  console.error('Operation failed:', error);
  // æœªæ¥: å‘é€åˆ°Sentry
}
```

### 2. æ€§èƒ½ç›‘æ§

**Web Vitals**:
```typescript
import { getCLS, getFID, getFCP, getLCP, getTTFB } from 'web-vitals';

getCLS(console.log);
getFID(console.log);
getFCP(console.log);
getLCP(console.log);
getTTFB(console.log);
```

---

## ğŸš€ æŒç»­é›†æˆ/éƒ¨ç½²

### GitHub Actions (æœªæ¥)

```yaml
name: CI/CD

on:
  push:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: npm install
      - run: npm test
      
  deploy:
    needs: test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: amondnet/vercel-action@v20
```

---

*æ–‡æ¡£ç»´æŠ¤è€…: Trading Journal Team*
*æœ€åæ›´æ–°: 2026å¹´2æœˆ4æ—¥*
